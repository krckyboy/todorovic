---
import BaseLayout from '../../layouts/BaseLayout.astro';
import BlogFilter from '../../modules/blog/components/BlogFilter.tsx';
import {
  getBlogTagOptions,
  getUnknownBlogTags,
  getListVisibleBlogPosts,
  serializeBlogPosts,
} from '../../modules/blog/services/blogPosts';

const sortedPosts = await getListVisibleBlogPosts();
const allTagOptions = getBlogTagOptions(sortedPosts);
const serializedPosts = serializeBlogPosts(sortedPosts);
const unknownTagSlugs = getUnknownBlogTags(sortedPosts);

if (unknownTagSlugs.length > 0) {
  console.warn(
    `[blog-tags] Unknown tags detected (warn-only): ${unknownTagSlugs.join(', ')}`,
  );
}

const title = 'Blog | Dušan Todorović on Web Development and Engineering';
const description =
  'Articles on frontend engineering, React, team leadership, and AI-assisted software development workflows.';
---

<BaseLayout title={title} description={description}>
  <div class="container content">
    <header class="page-header">
      <h1 class="u-heading-3xl-bold">Blog</h1>
      <p class="intro">
        Thoughts and tutorials on web development and software engineering.
      </p>
    </header>

    <BlogFilter
      client:load
      posts={serializedPosts}
      tagOptions={allTagOptions}
    />
  </div>
</BaseLayout>

<style>
  .page-header {
    padding-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-xl);
  }

  h1 {
    margin-bottom: var(--spacing-md);
  }

  .intro {
    font-size: var(--font-size-lg);
    line-height: var(--line-height-relaxed);
    color: var(--color-text-muted);
  }
</style>
