---
import BlogFilter from '../components/BlogFilter.tsx';
import {
  getBlogCategories,
  getSortedBlogPosts,
  serializeBlogPosts,
} from '../services/blogPosts';

interface Props {
  showHeader?: boolean;
  headerTitle?: string;
  headerIntro?: string;
}

const {
  showHeader = true,
  headerTitle = 'Blog',
  headerIntro = 'Thoughts and tutorials on web development and software engineering.',
} = Astro.props;

const sortedPosts = await getSortedBlogPosts();
const allCategories = getBlogCategories(sortedPosts);
const serializedPosts = serializeBlogPosts(sortedPosts);
---

<div class="blog-list-view">
  {
    showHeader && (
      <header class="page-header">
        <h1 class="u-heading-3xl-bold">{headerTitle}</h1>
        <p class="intro">{headerIntro}</p>
      </header>
    )
  }

  <BlogFilter client:load posts={serializedPosts} categories={allCategories} />
</div>

<style>
  .page-header {
    padding-top: var(--spacing-2xl);
    margin-bottom: var(--spacing-xl);
  }

  .page-header h1 {
    margin-bottom: var(--spacing-md);
  }

  .intro {
    font-size: var(--font-size-lg);
    line-height: var(--line-height-relaxed);
    color: var(--color-text-muted);
  }
</style>
